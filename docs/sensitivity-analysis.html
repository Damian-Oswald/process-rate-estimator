<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Process Rate Estimator (`PRE`) – 6&nbsp; Sensitivity analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./uncertainty-analysis.html" rel="next">
<link href="./results.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Process Rate Estimator</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/damian-oswald/process-rate-estimator/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sensitivity-analysis.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sensitivity analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./running-the-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Process rate estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sensitivity-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sensitivity analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./uncertainty-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uncertainty analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-prior" id="toc-sec-prior" class="nav-link active" data-scroll-target="#sec-prior"><span class="header-section-number">6.1</span> Defining the parameter distribution</a></li>
  <li><a href="#sec-sampling" id="toc-sec-sampling" class="nav-link" data-scroll-target="#sec-sampling"><span class="header-section-number">6.2</span> Sampling from the parameter space</a></li>
  <li><a href="#sec-calculating" id="toc-sec-calculating" class="nav-link" data-scroll-target="#sec-calculating"><span class="header-section-number">6.3</span> Calculating the model output of interest</a></li>
  <li><a href="#sec-emulator" id="toc-sec-emulator" class="nav-link" data-scroll-target="#sec-emulator"><span class="header-section-number">6.4</span> Emulation of the model outputs</a></li>
  <li><a href="#sec-contributions" id="toc-sec-contributions" class="nav-link" data-scroll-target="#sec-contributions"><span class="header-section-number">6.5</span> Estimate parameter contributions to the output variance</a>
  <ul class="collapse">
  <li><a href="#looking-at-the-raw-coefficients" id="toc-looking-at-the-raw-coefficients" class="nav-link" data-scroll-target="#looking-at-the-raw-coefficients">Looking at the raw coefficients</a></li>
  <li><a href="#standardized-regression-coefficients" id="toc-standardized-regression-coefficients" class="nav-link" data-scroll-target="#standardized-regression-coefficients">Standardized regression coefficients</a></li>
  <li><a href="#variance-decomposition" id="toc-variance-decomposition" class="nav-link" data-scroll-target="#variance-decomposition">Variance decomposition</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/damian-oswald/process-rate-estimator/blob/main/sensitivity-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/damian-oswald/process-rate-estimator/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sensitivity analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Sensitivity analysis is a method used to determine how different values of model parameters impact a particular model output value under a given set of assumptions <span class="citation" data-cites="trucano2006calibration">(<a href="references.html#ref-trucano2006calibration" role="doc-biblioref">Trucano et al. 2006</a>)</span>. Alternatively, this method is viewed as assessing a model’s sensitivity to its inputs rather than its parameters <span class="citation" data-cites="borgonovo2016sensitivity">(<a href="references.html#ref-borgonovo2016sensitivity" role="doc-biblioref">Borgonovo and Plischke 2016</a>)</span>.</p>
<p>In the context of the process rate estimator (PRE), the sensitivity analysis aims to quantify by how much the estimated process rates are affected by alterations to the least certain model parameters like isotope end members or bulk density. Since process rates are repeatedly estimated over time, the mean process rates over the entire time span are used for the sensitivity analysis. Any model inputs such as moisture, N<sub>2</sub>O, SP, and δ<sup>18</sup>O measurements on the other hand are taken for granted. It would be conceivable to extend the sensitivity analysis to encompass model input variables, additional model parameters or pre-processing variables, including physical parameters involved in pre-processing and the bandwidth parameter utilized for data smoothing, among others. However, such an extension would be extremely computationally expensive and was thus not performed.</p>
<p>By systematically varying key parameters, a sensitivity analysis helps in identifying which variables impact the outcome the most. Generally, sensitivity analyses are conducted in five steps:</p>
<ol type="1">
<li><a href="./sensitivity-analysis.html#sec-prior">Defining the parameter distribution</a>, ideally reflecting the uncertainty around each parameter.</li>
<li><a href="./sensitivity-analysis.html#sec-sampling">Sampling from the parameter space</a>, i.e.&nbsp;from each parameter distribution.</li>
<li><a href="./sensitivity-analysis.html#sec-calculating">Calculating the model output of interest</a> by running the model for each sampled set of parameters.</li>
<li><a href="./sensitivity-analysis.html#sec-emulator">Approximate the model</a> output based on inputs with an emulator.</li>
<li>Use the emulator to <a href="./sensitivity-analysis.html#sec-contributions">estimate parameter contributions</a> to the output variance.</li>
</ol>
<p>The first step is usually the hardest one, as it requires an extensive review of prior knowledge of the parameters. Global sensitivity analysis examines the allocation of output uncertainty in a model (whether numerical or not) to various input uncertainty sources. The term “global” is specifically used to distinguish it from the more commonly encountered local or one-factor-at-a-time analyses found in the literature, as highlighted by <span class="citation" data-cites="saltelli2004global">Saltelli (<a href="references.html#ref-saltelli2004global" role="doc-biblioref">2004</a>)</span>.</p>
<section id="sec-prior" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-prior"><span class="header-section-number">6.1</span> Defining the parameter distribution</h2>
<p>The first step of the sensitivity analysis incorporates expressing the known uncertainty of each parameter as a distribution. The chosen distribution of the parameters is displayed in <a href="#tbl-sensitivity" class="quarto-xref">table&nbsp;<span>6.1</span></a>. It is adopted from <span class="citation" data-cites="yu2020can">Yu et al. (<a href="references.html#ref-yu2020can" role="doc-biblioref">2020</a>)</span>, but in turn also based on research from <span class="citation" data-cites="well2008isotope">Well and Flessa (<a href="references.html#ref-well2008isotope" role="doc-biblioref">2008</a>)</span>, <span class="citation" data-cites="decock2013potential">Decock and Six (<a href="references.html#ref-decock2013potential" role="doc-biblioref">2013</a>)</span>, <span class="citation" data-cites="lewicka2017quantifying">Lewicka-Szczebak et al. (<a href="references.html#ref-lewicka2017quantifying" role="doc-biblioref">2017</a>)</span> and <span class="citation" data-cites="denk2017nitrogen">Denk et al. (<a href="references.html#ref-denk2017nitrogen" role="doc-biblioref">2017</a>)</span>.</p>
<div id="tbl-sensitivity" class="quarto-float anchored" data-tbl-colwidths="[28,18,18,36]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sensitivity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.1: Isotope end-members values used for modeling gross nitrification derived N<sub>2</sub>O production, gross denitrification derived N<sub>2</sub>O production, and gross N<sub>2</sub>O reduction. End-members are adopted from <span class="citation" data-cites="yu2020can">Yu et al. (<a href="references.html#ref-yu2020can" role="doc-biblioref">2020</a>)</span>. For propagating the parameter uncertainty in the sensitivity and uncertainty analysis, parameters are randomly sampled either from a Gaussian <span class="math inline">\(\mathcal N(\mu, \sigma^2)\)</span> or a uniform <span class="math inline">\(\mathcal U (a,b)\)</span> distribution.
</figcaption>
<div aria-describedby="tbl-sensitivity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th></th>
<th>Value [‰]</th>
<th>Parameter uncertainty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>BD</code></td>
<td>Bulk density</td>
<td>1.686</td>
<td><span class="math inline">\(\sim \mathcal{U} (\left\{1.59, 1.61, ..., 1.77, 1.79\right\})\)</span></td>
</tr>
<tr class="even">
<td><code>eta_SP_diffusion</code></td>
<td><span class="math inline">\(\eta\: \text{SP}_\text{diff.}\)</span></td>
<td>1.55</td>
<td><span class="math inline">\(\sim \mathcal{N}(1.55, 0.28^2)\)</span></td>
</tr>
<tr class="odd">
<td><code>eta_18O_diffusion</code></td>
<td><span class="math inline">\(\eta\ce{^{18}O}_\text{diff.}\)</span></td>
<td>-7.79</td>
<td><span class="math inline">\(\sim \mathcal{N}(-7.79, 0.27^2)\)</span></td>
</tr>
<tr class="even">
<td><code>SP_nitrification</code></td>
<td><span class="math inline">\(\text{SP}_\text{nit.}\)</span></td>
<td>35</td>
<td><span class="math inline">\(\sim \mathcal{U}(32, 38.7)\)</span></td>
</tr>
<tr class="odd">
<td><code>d18O_nitrification</code></td>
<td><span class="math inline">\(\delta\ce{^{18}O_\text{nit.}}\)</span></td>
<td>23.5</td>
<td><span class="math inline">\(\sim \mathcal{N}(23.5, 3^2)\)</span></td>
</tr>
<tr class="even">
<td><code>SP_denitrification</code></td>
<td><span class="math inline">\(\text{SP}_\text{den.}\)</span></td>
<td>-4.85</td>
<td><span class="math inline">\(\sim \mathcal{U}(-13.6, 3.7)\)</span></td>
</tr>
<tr class="odd">
<td><code>d18O_denitrification</code></td>
<td><span class="math inline">\(\delta\ce{^{18}O_\text{den.}}\)</span></td>
<td>9.3</td>
<td><span class="math inline">\(\sim \mathcal{U}(2.5, 13.4)\)</span></td>
</tr>
<tr class="even">
<td><code>eta_SP_reduction</code></td>
<td><span class="math inline">\(\eta\:\text{SP}_\text{red.}\)</span></td>
<td>-5.9</td>
<td><span class="math inline">\(\sim \mathcal{U}(-8.2, -2.9)\)</span></td>
</tr>
<tr class="odd">
<td><code>eta_18O_reduction</code></td>
<td><span class="math inline">\(\eta\ce{^{18}O_\text{red.}}\)</span></td>
<td>-15.4</td>
<td><span class="math inline">\(\sim \mathcal{U}(-25.1, -5.1)\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>As noted in the table, parameters are either drawn from a Gaussian distribution specified by its mean and variance <span class="math inline">\(\mathcal N(\mu, \sigma^2)\)</span> or from a uniform distribution specified by a lower and upper bound <span class="math inline">\(\mathcal U (a,b)\)</span>. There’s one exception to this: the bulk density is sampled from a predefined set of values. This procedure allowed to re-use the same prepared data (as described in chapter 3) for multiple parameter sets and thus made the sensitivity less computationally intensive.</p>
</section>
<section id="sec-sampling" class="level2 page-columns page-full" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-sampling"><span class="header-section-number">6.2</span> Sampling from the parameter space</h2>
<p>The next step of the sensitivity analysis involves sampling specific instances from the specified parameter space. This step, as well as the following ones, are performed by an R script. The script used to run the sensitivity analysis can be found in the <a href="https://github.com/Damian-Oswald/process-rate-estimator">respective GitHub repository</a>. After successfully cloning the repository, the results of the sensitivity analysis can be reproduced simply by running the following command in the terminal.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> scripts/sensitivity-analysis/01-sensitivitiy-analysis.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For documentation purposes, some snippets of that script are highlighted in this section. The following code defines that the sensitivity analysis ought to be applied on all combinations of columns and depths. Here, we are choosing a sample size of 300, which means that for every distinct combination of depth and column, we will be sampling 300 sets of parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>COLUMNS <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>DEPTHS <span class="ot">=</span> PRE<span class="sc">::</span><span class="fu">getParameters</span>()<span class="sc">$</span>depths</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>SAMPLESIZE <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>SAMPLEREPEAT <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> SAMPLESIZE <span class="sc">*</span> <span class="fu">length</span>(COLUMNS) <span class="sc">*</span> <span class="fu">length</span>(DEPTHS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To conduct the sensitivity analysis, a data frame with parameters sampled according to the distributions in <a href="#tbl-sensitivity" class="quarto-xref">Table&nbsp;<span>6.1</span></a> is created. We draw <code>n</code> parameter sets in total, where <code>n</code> is calculated based on the columns, depth layers and the <code>SAMPLESIZE</code> variable – in the script set to be 300. Note that in order to boost the sensitivity analysis, we only run the process rate estimator with 15 samples<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> for the <code>BB::multiStart</code> solver for every day.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;In the <code>longPRE</code> function from the package <code>PRE</code>, this number is passed via the argument <code>n</code>.</p></div></div><div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand.grid</span>(<span class="at">repetition =</span> <span class="dv">1</span><span class="sc">:</span>SAMPLESIZE,</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">column =</span> COLUMNS,</span>
<span id="annotated-cell-3-4"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">depth =</span> DEPTHS)[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n),<span class="sc">-</span><span class="dv">1</span>],</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-5" class="code-annotation-target"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">BD =</span> <span class="fu">sort</span>(<span class="fu">rep</span>(PRE<span class="sc">::</span><span class="fu">getParameters</span>()<span class="sc">$</span>BD<span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="at">l=</span><span class="dv">11</span>),<span class="at">l=</span>n)),</span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta_SP_diffusion =</span> <span class="fu">rnorm</span>(n, <span class="fl">1.55</span>, <span class="fl">0.28</span>),</span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta_18O_diffusion =</span> <span class="fu">rnorm</span>(n, <span class="sc">-</span><span class="fl">7.79</span>, <span class="fl">0.27</span>),</span>
<span id="annotated-cell-3-8"><a href="#annotated-cell-3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SP_nitrification =</span> <span class="fu">runif</span>(n, <span class="dv">32</span>, <span class="fl">38.7</span>),</span>
<span id="annotated-cell-3-9"><a href="#annotated-cell-3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">d18O_nitrification =</span> <span class="fu">rnorm</span>(n, <span class="fl">23.5</span>, <span class="dv">3</span>),</span>
<span id="annotated-cell-3-10"><a href="#annotated-cell-3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">SP_denitrification =</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="fl">13.6</span>, <span class="fl">3.7</span>),</span>
<span id="annotated-cell-3-11"><a href="#annotated-cell-3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">d18O_denitrification =</span> <span class="fu">runif</span>(n, <span class="fl">2.5</span>, <span class="fl">13.4</span>),</span>
<span id="annotated-cell-3-12"><a href="#annotated-cell-3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta_SP_reduction =</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="fl">8.2</span>,<span class="sc">-</span><span class="fl">2.9</span>),</span>
<span id="annotated-cell-3-13"><a href="#annotated-cell-3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta_18O_reduction =</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="fl">25.1</span>,<span class="sc">-</span><span class="fl">5.1</span>)</span>
<span id="annotated-cell-3-14"><a href="#annotated-cell-3-14" aria-hidden="true" tabindex="-1"></a>    )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2,4" data-code-annotation="1">Randomly re-order the variables for repetition, column and depth.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="5" data-code-annotation="2">Sort the generated parameter values for bulk density.</span>
</dd>
</dl>
</div>
</div>
<p>Note that the experimental parameter grid (containing information about column and depth layer) is shuffled randomly. We do this to prevent columns or depths to correlate with the bulk density (<code>BD</code>). The bulk density parameter needs to be sorted, since it’s not a parameter that’s passed to the PRE model, but rather one that is used to prepare the data used in the model. In order to reduce the number of times needed to prepare said data, we’ll sort <code>BD</code> and we’ll only update the data if <code>BD</code> changes.</p>
</section>
<section id="sec-calculating" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-calculating"><span class="header-section-number">6.3</span> Calculating the model output of interest</h2>
<p>Next, we’ll loop over every row in the newly created <code>parameters</code> data frame. Each row contains a set of unique parameters to re-run the process rate estimator on. The results will be saved in a corresponding data frame – this constitutes the data to be analyzed for the sensitivity analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Nitrification =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n),</span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Denitrification =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n),</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Reduction =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n))</span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>BD <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span>(parameters[i,<span class="st">"BD"</span>]<span class="sc">==</span>BD)){</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>        BD <span class="ot">&lt;-</span> parameters[i,<span class="st">"BD"</span>]</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>        P <span class="ot">&lt;-</span> <span class="fu">getParameters</span>(<span class="at">BD =</span> BD)</span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> PRE<span class="sc">::</span>measurements <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">getN2ON</span>(P) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">getMissing</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">calculateFluxes</span>(P, <span class="cn">FALSE</span>)</span>
<span id="annotated-cell-4-13"><a href="#annotated-cell-4-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="annotated-cell-4-14"><a href="#annotated-cell-4-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">longPRE</span>(<span class="at">data =</span> data,</span>
<span id="annotated-cell-4-15"><a href="#annotated-cell-4-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">column =</span> parameters[i,<span class="st">"column"</span>],</span>
<span id="annotated-cell-4-16"><a href="#annotated-cell-4-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">depth =</span> parameters[i,<span class="st">"depth"</span>],</span>
<span id="annotated-cell-4-17"><a href="#annotated-cell-4-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n =</span> SAMPLEREPEAT,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-18" class="code-annotation-target"><a href="#annotated-cell-4-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parameters =</span> <span class="fu">do.call</span>(PRE<span class="sc">::</span>getParameters,</span>
<span id="annotated-cell-4-19"><a href="#annotated-cell-4-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.list</span>(parameters[i,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)])),</span>
<span id="annotated-cell-4-20"><a href="#annotated-cell-4-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-21" class="code-annotation-target"><a href="#annotated-cell-4-21" aria-hidden="true" tabindex="-1"></a>    results[i,] <span class="ot">&lt;-</span> x[[<span class="st">"processes"</span>]]</span>
<span id="annotated-cell-4-22"><a href="#annotated-cell-4-22" aria-hidden="true" tabindex="-1"></a>}</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6,13" data-code-annotation="1">Check if the bulk density value <code>BD</code> has changed since the last iteration. If not, there is no need to repeat the data preparation process.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="18,19" data-code-annotation="2">Use the <code>PRE::getParameters</code> function to swap all relevant parameters for the process rate estimator with the current set of sampled parameters.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="21" data-code-annotation="3">Save the results <code>x</code> in a table called <code>results</code>.</span>
</dd>
</dl>
</div>
</div>
<p>Note that running this entire script may take a few days as many resource intensive computations are repeated thousands of times.</p>
</section>
<section id="sec-emulator" class="level2 page-columns page-full" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-emulator"><span class="header-section-number">6.4</span> Emulation of the model outputs</h2>
<p>To conduct the sensitivity analysis, we now model the results based on the sampled parameters – so we treat the sampled parameters as independent variables <span class="math inline">\(\mathbf X\)</span>, and the computed mean process rates over time as dependent variables <span class="math inline">\(\mathbf Y\)</span>.</p>
<p>A commonly applied method of sensitivity analysis is Sobol’s method, which decomposes the total variance and assigns it to individual parameters specific interactions <span class="citation" data-cites="sobol1990sensitivity">(<a href="references.html#ref-sobol1990sensitivity" role="doc-biblioref">Sobol’ 1990</a>)</span>. However, Sobol’s method requires a large number of resampling, and is thus unfit for this application, because every model run is rather expensive. Instead, a linear regression model is used as an emulator. Often, this works fine enough because even though the response might not be linear overall, it can be approximated well enough by a linear model on a specific parameter interval.</p>
<p>First, we might look at the pairwise correlations between columns of <span class="math inline">\(\mathbf X\)</span> and <span class="math inline">\(\mathbf Y\)</span>, i.e.&nbsp;all combinations of process rates as well as bulk density and isotope end members (<a href="#fig-sensitivity" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>).</p>
<div class="page-columns page-full">
<div id="fig-sensitivity" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-sensitivity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="scripts/sensitivity-analysis/output/sensitivity-1-7.5.svg" class="img-fluid figure-img column-screen-inset" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sensitivity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Pairwise results of the process rates (y-axis) and the isotope end members (x-axis) for column 1 at 7.5 cm depth. To evaluate the results of other depth-column combinations, visit the <a href="https://github.com/Damian-Oswald/process-rate-estimator/tree/main/scripts/sensitivity-analysis/output">respective GitHub repository site</a>. The red lines indicate the respective linear models with their 95% conficence intervals. The black bar to the right of each plot represents the magnitude of the absolute standardized regression coefficient (SRC). The absolute SRC can range from 0 to 1, where an SRC of 1 would range the entire plot plane. As such, these bars represent the importance of a given parameter for emulating the respective process.
</figcaption>
</figure>
</div>
</div>
<p><a href="#fig-sensitivity" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> already reveals quite a lot, but in order to quantify the individual effects, it would be better to construct a multivariate linear regression model where we include all isotope end members at the same time.</p>
<p><span id="eq-lm"><span class="math display">\[\mathbf Y = \mathbf X \mathbf B + \mathbf U \tag{6.1}\]</span></span></p>
<p>For further analysis, we are interested in the coefficients <span class="math inline">\(\mathbf B\)</span> of this multivariate linear model, not its predictions. Individual coefficients will be referred to as <span class="math inline">\(\beta_i\)</span>. Note that ever though an intercept <span class="math inline">\(\beta_0\)</span> is included in these models, it is not interesting and thus will be excluded from further analyses.</p>
<p>A model as specified in <a href="#eq-lm" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> is fit for every combination of depth and column separately. Thus, this leads to repeated coefficient estimates for each parameter (or variable, in this context).</p>
</section>
<section id="sec-contributions" class="level2 page-columns page-full" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="sec-contributions"><span class="header-section-number">6.5</span> Estimate parameter contributions to the output variance</h2>
<p>In this section, the focus is on interpreting the raw coefficients <span class="math inline">\(\boldsymbol \beta\)</span> derived from the set of linear regression models that were fit in the last section. These coefficients provide a numerical representation of the influence each parameter has on the process rate estimates.</p>
<section id="looking-at-the-raw-coefficients" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="looking-at-the-raw-coefficients">Looking at the raw coefficients</h3>
<p>Each coefficient <span class="math inline">\(\beta_i\)</span> represents the change in the output variable for a one-unit change in the parameter, holding all other parameters constant. This allows us to directly assess the sensitivity of the model to changes in each specific parameter.</p>
<p>By reviewing the coefficients in <a href="#tbl-coefficients" class="quarto-xref">table&nbsp;<span>6.2</span></a>, we can identify which parameters are more influential and may thus deserve further attention to reduce uncertainty in the process rate estimator.</p>
<div id="tbl-coefficients" class="cell quarto-float anchored" data-tbl-colwidths="[10,30,30,30]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.2: Coefficients (<span class="math inline">\(\mu\)</span> ± <span class="math inline">\(\sigma\)</span>) for the models fit on combinations of depth and column. Note that the unit of the bulk density from the istope end members, hence the coefficients are not directly comparable.
</figcaption>
<div aria-describedby="tbl-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="cell table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Nitrification</th>
<th style="text-align: right;">Denitrification</th>
<th style="text-align: right;">Reduction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bulk density</td>
<td style="text-align: right;">-21 ± 31</td>
<td style="text-align: right;">2.3 ± 40</td>
<td style="text-align: right;">45 ± 65</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\eta\;\text{SP}_{\text{diffusion}}\)</span></td>
<td style="text-align: right;">0.74 ± 1.2</td>
<td style="text-align: right;">-0.35 ± 0.61</td>
<td style="text-align: right;">0.055 ± 0.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\eta^{18}\text{O}_\text{diffusion}\)</span></td>
<td style="text-align: right;">-0.25 ± 0.61</td>
<td style="text-align: right;">-0.65 ± 1.2</td>
<td style="text-align: right;">-0.088 ± 1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\text{SP}_\text{nitrification}\)</span></td>
<td style="text-align: right;">-0.17 ± 0.4</td>
<td style="text-align: right;">0.13 ± 0.25</td>
<td style="text-align: right;">0.094 ± 0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta\;^18\text{O}_\text{nitrification}\)</span></td>
<td style="text-align: right;">0.089 ± 0.23</td>
<td style="text-align: right;">0.056 ± 0.17</td>
<td style="text-align: right;">-0.12 ± 0.26</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\text{SP}_\text{denitrification}\)</span></td>
<td style="text-align: right;">-0.42 ± 0.18</td>
<td style="text-align: right;">0.23 ± 0.094</td>
<td style="text-align: right;">-0.014 ± 0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta\;^18\text{O}_\text{denitrification}\)</span></td>
<td style="text-align: right;">0.15 ± 0.085</td>
<td style="text-align: right;">0.29 ± 0.21</td>
<td style="text-align: right;">-0.14 ± 0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\eta\;\text{SP}_{\text{reduction}}\)</span></td>
<td style="text-align: right;">0.76 ± 0.39</td>
<td style="text-align: right;">-0.42 ± 0.18</td>
<td style="text-align: right;">0.016 ± 0.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\eta^{18}\text{O}_\text{reduction}\)</span></td>
<td style="text-align: right;">-0.31 ± 0.2</td>
<td style="text-align: right;">-0.47 ± 0.33</td>
<td style="text-align: right;">0.29 ± 0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">adjusted R<sup>2</sup></td>
<td style="text-align: right;">0.95 ± 0.043</td>
<td style="text-align: right;">0.94 ± 0.057</td>
<td style="text-align: right;">0.92 ± 0.091</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>When interpreting the raw coefficients <span class="math inline">\(\boldsymbol \beta\)</span> in the regression models used in the sensitivity analysis, it’s important to note that these coefficients reflect the effect size of each parameter at a fixed value, assuming other parameters are held constant. However, these coefficients do not take into account the prior uncertainty associated with each parameter listed in <a href="#tbl-sensitivity" class="quarto-xref">table&nbsp;<span>6.1</span></a>.</p>
<div class="page-columns page-full">
<div id="fig-coefficients" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="scripts/sensitivity-analysis/output/Coefficients.svg" class="img-fluid figure-img column-screen-inset-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Results of the coefficients for all processes and parameters. The bulk density (<code>BD</code>) was omitted from this graph because its unit and hence its parameter’s magnitude differs from the istope end members. The mangitude of the coefficients can be interpreted as the effect size said parameter would have without considering its uncertainty.
</figcaption>
</figure>
</div>
</div>
<p>This means that while a coefficient can indicate how much the output will change with a one-unit change in the parameter, it doesn’t take into account the uncertainty of the parameter itself, which is also a driver of the overall contribution to the model sensitivity. In order to consider the actual contribution of parameters to the model outcome variability, looking at the standardized regression coefficient is more appropriate.</p>
</section>
<section id="standardized-regression-coefficients" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="standardized-regression-coefficients">Standardized regression coefficients</h3>
<p>The standardized regression coefficient (SRC, <span class="math inline">\(\beta^\ast\)</span>), often referred to as beta coefficient in statistical models, measures the strength and direction of the relationship between an independent variable and the dependent variable in a regression model, with all variables being standardized. The SRC can be calculated as:</p>
<p><span id="eq-src"><span class="math display">\[\beta^\ast_i = \frac{\sigma_{x_i}}{\sigma_y} \beta_i \tag{6.2}\]</span></span></p>
<p>where <span class="math inline">\(\beta_i\)</span> is the estimated coefficient of a predictor <span class="math inline">\(x_i\)</span> in a linear model, <span class="math inline">\(\sigma_{x_i}\)</span> is the predictor’s standard deviation, while <span class="math inline">\(\sigma_{y}\)</span> is the response’s standard deviation. A consequence of standardizing the coefficients is that they all fall into the range between -1 and 1.</p>
<p>The key advantage of using standardized regression coefficients is that it allows for direct comparison of the relative importance or impact of each independent variable on the dependent variable across different studies or models, even when the variables are measured on different scales. This enables a clearer understanding of which variables have the most significant influence on the outcome, making it a useful tool for a sensitivity analysis. Now, the value assigned to each parameter represents its relative importance (<a href="#tbl-src" class="quarto-xref">Table&nbsp;<span>6.3</span></a>).</p>
<div id="tbl-src" class="cell quarto-float anchored" data-tbl-colwidths="[10,30,30,30]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-src-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.3: Standardized regression coefficients (<span class="math inline">\(\mu\)</span> ± <span class="math inline">\(\sigma\)</span>) for the models fit on combinations of depth and column.
</figcaption>
<div aria-describedby="tbl-src-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="cell table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Nitrification</th>
<th style="text-align: left;"></th>
<th style="text-align: right;">Denitrification</th>
<th style="text-align: left;"></th>
<th style="text-align: right;">Reduction</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bulk density</td>
<td style="text-align: right;">-0.31 ± 0.27</td>
<td style="text-align: left;">(12%)</td>
<td style="text-align: right;">0.064 ± 0.41</td>
<td style="text-align: left;">(0.64%)</td>
<td style="text-align: right;">0.51 ± 0.44</td>
<td style="text-align: left;">(50%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\eta\;\text{SP}_{\text{diffusion}}\)</span></td>
<td style="text-align: right;">0.048 ± 0.056</td>
<td style="text-align: left;">(0.28%)</td>
<td style="text-align: right;">-0.023 ± 0.031</td>
<td style="text-align: left;">(0.079%)</td>
<td style="text-align: right;">0.0026 ± 0.026</td>
<td style="text-align: left;">(0.0012%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\eta^{18}\text{O}_\text{diffusion}\)</span></td>
<td style="text-align: right;">-0.013 ± 0.024</td>
<td style="text-align: left;">(0.02%)</td>
<td style="text-align: right;">-0.033 ± 0.052</td>
<td style="text-align: left;">(0.17%)</td>
<td style="text-align: right;">-0.0045 ± 0.061</td>
<td style="text-align: left;">(0.0038%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\text{SP}_\text{nitrification}\)</span></td>
<td style="text-align: right;">-0.062 ± 0.077</td>
<td style="text-align: left;">(0.47%)</td>
<td style="text-align: right;">0.06 ± 0.08</td>
<td style="text-align: left;">(0.55%)</td>
<td style="text-align: right;">0.037 ± 0.034</td>
<td style="text-align: left;">(0.26%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta\;^18\text{O}_\text{nitrification}\)</span></td>
<td style="text-align: right;">0.047 ± 0.057</td>
<td style="text-align: left;">(0.26%)</td>
<td style="text-align: right;">0.035 ± 0.091</td>
<td style="text-align: left;">(0.19%)</td>
<td style="text-align: right;">-0.075 ± 0.11</td>
<td style="text-align: left;">(1.1%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\text{SP}_\text{denitrification}\)</span></td>
<td style="text-align: right;">-0.57 ± 0.15</td>
<td style="text-align: left;">(39%)</td>
<td style="text-align: right;">0.27 ± 0.11</td>
<td style="text-align: left;">(12%)</td>
<td style="text-align: right;">-0.023 ± 0.1</td>
<td style="text-align: left;">(0.1%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta\;^18\text{O}_\text{denitrification}\)</span></td>
<td style="text-align: right;">0.12 ± 0.057</td>
<td style="text-align: left;">(1.9%)</td>
<td style="text-align: right;">0.2 ± 0.082</td>
<td style="text-align: left;">(6.5%)</td>
<td style="text-align: right;">-0.12 ± 0.14</td>
<td style="text-align: left;">(2.6%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\eta\;\text{SP}_{\text{reduction}}\)</span></td>
<td style="text-align: right;">0.32 ± 0.16</td>
<td style="text-align: left;">(12%)</td>
<td style="text-align: right;">-0.16 ± 0.086</td>
<td style="text-align: left;">(4.2%)</td>
<td style="text-align: right;">0.014 ± 0.052</td>
<td style="text-align: left;">(0.039%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\eta^{18}\text{O}_\text{reduction}\)</span></td>
<td style="text-align: right;">-0.48 ± 0.25</td>
<td style="text-align: left;">(28%)</td>
<td style="text-align: right;">-0.67 ± 0.36</td>
<td style="text-align: left;">(71%)</td>
<td style="text-align: right;">0.45 ± 0.43</td>
<td style="text-align: left;">(38%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">adjusted R<sup>2</sup></td>
<td style="text-align: right;">0.95 ± 0.043</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.94 ± 0.057</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.92 ± 0.091</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Standardizing the coefficients changes the results seen in <a href="#tbl-coefficients" class="quarto-xref">table&nbsp;<span>6.2</span></a> and <a href="#fig-coefficients" class="quarto-xref">figure&nbsp;<span>6.2</span></a>. Note that the coefficients of column, depth and their interactions are excluded from this table, even though they are more explanatory than the isotope end members.</p>
<div class="page-columns page-full">
<div id="fig-src" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-src-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="scripts/sensitivity-analysis/output/SRC.svg" class="img-fluid figure-img column-screen-inset-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-src-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Results of the standardized regression coefficients (SRC) for all processes and parameters. The mangitude of the SRC can be interpreted as the effect size of said parameter: by how much does its uncertainty contribute to the overall uncertainty?
</figcaption>
</figure>
</div>
</div>
<p>The interpretation of standard regression coefficients is not quite straightforward – remember; standard deviations are not cumulative, only variance is. So, to indicate proportional share of explained variance, the squared SRC would need to be compared.</p>
</section>
<section id="variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="variance-decomposition">Variance decomposition</h3>
<p>Squaring the standardized regression coefficient is related to the variance decomposition performed by the analysis of variance (ANOVA), which was developed and formally described by Ronald A. Fisher <span class="citation" data-cites="fisher1926arrangement fisher1966design">(<a href="references.html#ref-fisher1926arrangement" role="doc-biblioref">Fisher 1926</a>, <a href="references.html#ref-fisher1966design" role="doc-biblioref">Fisher 1935</a>)</span>. In the absence of multicollinearity, the expected values of both the ANOVA relative sum of squares and the squared SRC are the same <span class="citation" data-cites="novak2015partial">(<a href="references.html#ref-novak2015partial" role="doc-biblioref">Novak 2015</a>)</span>. However, the ANOVA has the nice property that the assigned variance explained matches the overall goodness of fit (R<sup>2</sup>) of the models perfectly. Thus, the final variance decomposition is computed from a classical multi-way ANOVA.</p>
<div id="fig-anova" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="scripts/sensitivity-analysis/output/SRC-importances.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Overall results of the sensitivity analysis. The three show the share of variance explained by each parameter, calculated from the absolute standardized regression coefficients. Note that linear models did not explain the variance equally well for all three processes. The hatched area represents the variance unexplained by the linear models computed as the residual relative sum of squares (1 - R<sup>2</sup>).
</figcaption>
</figure>
</div>
<p>The results shown in <a href="#fig-anova" class="quarto-xref">figure&nbsp;<span>6.4</span></a> allow us to assign percentage-wise contributions to the variance explained to the individual parameters inspected during the sensitivity analysis. Averaged over all processes, <span class="math inline">\(\eta\ce{^{18}O_\text{reduction}}\)</span> contributes most to the variance in the processes (40.9%), followed by the bulk density (26.3%) and <span class="math inline">\(\text{SP}_\text{denitrification}\)</span> (14.3%). All other parameters combined only explain little variance (12.2%). Also, on average, 6.3% of the variance is left unexplained by the linear models.</p>
<p>The source of the unexplained variance in <a href="#fig-anova" class="quarto-xref">figure&nbsp;<span>6.4</span></a> may be attributed to one of two sources: either it stems from the variance of the process rate estimate themselves, or from a non-linear response of the mean process rate estimates to changes in the parameters. The results in <a href="#tbl-small-variance-test" class="quarto-xref">table&nbsp;<span>6.4</span></a> seem to suggest that at least some of the variance (between 0.46% and 1.04% percentage points, as <code>SAMPLEREPEAT = 15</code> was used for the sensitivity analysis) stems from the inherent uncertainty of the process rate estimator itself. That would translate to little more than 10% of the unexplained variance as it is determined by the analysis of variance. This share could be further reduced by using a larger <code>SAMPLEREPEAT</code> number, but according to the law of large numbers, the computational cost to do so would increase quadratically.</p>
<div id="tbl-small-variance-test" class="quarto-float anchored" data-colwidths="[20,35,15,15,15]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-small-variance-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.4: Results showing the effect of the <code>SAMPLEREPEAT</code> parameter in the <code>longPRE</code> function on the mean, standard deviation, and coefficient of variation for mean nitrification, denitrification, and reduction processes.
</figcaption>
<div aria-describedby="tbl-small-variance-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th><code>SAMPLEREPEAT</code></th>
<th>Metric</th>
<th>Nitrification</th>
<th>Denitrification</th>
<th>Reduction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>5</code></td>
<td>Mean<br>
Standard deviation<br>
Coefficient of variation</td>
<td>13.784<br>
0.129<br>
0.94%</td>
<td>14.172<br>
0.198<br>
1.40%</td>
<td>26.633<br>
0.584<br>
2.19%</td>
</tr>
<tr class="even">
<td><code>15</code></td>
<td>Mean<br>
Standard deviation<br>
Coefficient of variation</td>
<td>13.818<br>
0.063<br>
0.46%</td>
<td>14.234<br>
0.094<br>
0.66%</td>
<td>26.821<br>
0.279<br>
1.04%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Not every parameter explains the variance in the process rate estimates equally well for different processes. For example, the variance in the estimated reduction rates are reasonably well explained (83.7%) only by bulk density and <span class="math inline">\(\eta\ce{^{18}O_\text{reduction}}\)</span> alone. Bulk density seems much less capable in explaining the variance in the estimated nitrification and denitrification rates, on the other hand. For these two processes, <span class="math inline">\(\text{SP}_\text{denitrification}\)</span> and <span class="math inline">\(\eta\ce{^{18}O_\text{reduction}}\)</span> seem to be the more driving factors.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-borgonovo2016sensitivity" class="csl-entry" role="listitem">
Borgonovo, E., and E. Plischke. 2016. <a href="https://doi.org/10.1016/j.ejor.2015.06.032">Sensitivity analysis: A review of recent advances</a>. European Journal of Operational Research 248:869–887.
</div>
<div id="ref-decock2013potential" class="csl-entry" role="listitem">
Decock, C., and J. Six. 2013. <a href="https://doi.org/10.1111/ejss.12068">On the potential of <span><span class="math inline">\(\delta^{18}\text{O}\)</span></span> and <span><span class="math inline">\(\delta^{15}\text{N}\)</span></span> to assess <span><span class="math inline">\(\text{N}_2\text{O}\)</span></span> reduction to <span><span class="math inline">\(\text{N}_2\)</span></span> in soil</a>. European journal of soil science 64:610–620.
</div>
<div id="ref-denk2017nitrogen" class="csl-entry" role="listitem">
Denk, T. R., J. Mohn, C. Decock, D. Lewicka-Szczebak, E. Harris, K. Butterbach-Bahl, R. Kiese, and B. Wolf. 2017. <a href="https://www.dora.lib4ri.ch/empa/islandora/object/empa%3A13499">The nitrogen cycle: A review of isotope effects and isotope modeling approaches</a>. Soil Biology and Biochemistry 105:121–137.
</div>
<div id="ref-fisher1926arrangement" class="csl-entry" role="listitem">
Fisher, R. A. 1926. <a href="https://doi.org/10.1007/978-1-4612-4380-9_8">The arrangement of field experiments</a>.
</div>
<div id="ref-fisher1966design" class="csl-entry" role="listitem">
Fisher, R. A. 1935. <a href="https://books.google.ch/books?id=-EsNAQAAIAAJ">The design of experiments</a>. Oliver; Boyd Edinburgh.
</div>
<div id="ref-lewicka2017quantifying" class="csl-entry" role="listitem">
Lewicka-Szczebak, D., J. Augustin, A. Giesemann, and R. Well. 2017. <a href="https://doi.org/10.5194/bg-14-711-2017">Quantifying <span><span class="math inline">\(\text{N}_2 \text{O}\)</span></span> reduction to <span><span class="math inline">\(\text{N}_2\)</span></span> based on <span><span class="math inline">\(\text{N}_2 \text{O}\)</span></span> isotopocules – validation with independent methods (helium incubation and <span><span class="math inline">\(^{15}\text{N}\)</span></span> gas flux method)</a>. Biogeosciences 14:711–732.
</div>
<div id="ref-novak2015partial" class="csl-entry" role="listitem">
Novak, C. 2015. <a href="https://stats.stackexchange.com/questions/64010/importance-of-predictors-in-multiple-regression-partial-r2-vs-standardized">Importance of predictors in multiple regression: Partial R² vs. Standardized coefficients</a>. Online.
</div>
<div id="ref-saltelli2004global" class="csl-entry" role="listitem">
Saltelli, A. 2004. <a href="https://citeseerx.ist.psu.edu/document?doi=a7ab24d4a6317f53754641717759777680eb8b77">Global sensitivity analysis: An introduction</a>. Page 43 Proc. 4th international conference on sensitivity analysis of model output (SAMO’04). Citeseer.
</div>
<div id="ref-sobol1990sensitivity" class="csl-entry" role="listitem">
Sobol’, I. M. 1990. On sensitivity estimation for nonlinear mathematical models. Matematicheskoe modelirovanie 2:112–118.
</div>
<div id="ref-trucano2006calibration" class="csl-entry" role="listitem">
Trucano, T. G., L. P. Swiler, T. Igusa, W. L. Oberkampf, and M. Pilch. 2006. <a href="https://doi.org/10.1016/j.ress.2005.11.031">Calibration, validation, and sensitivity analysis: What’s what</a>. Reliability Engineering &amp; System Safety 91:1331–1357.
</div>
<div id="ref-well2008isotope" class="csl-entry" role="listitem">
Well, R., and H. Flessa. 2008. <a href="https://doi.org/10.1002/rcm.3656">Isotope fractionation factors of <span><span class="math inline">\(\text{N}_2\text{O}\)</span></span> diffusion</a>. Rapid Communications in Mass Spectrometry: An International Journal Devoted to the Rapid Dissemination of Up-to-the-Minute Research in Mass Spectrometry 22:2621–2628.
</div>
<div id="ref-yu2020can" class="csl-entry" role="listitem">
Yu, L., E. Harris, D. Lewicka-Szczebak, M. Barthel, M. R. Blomberg, S. J. Harris, M. S. Johnson, M. F. Lehmann, J. Liisberg, C. Müller, and others. 2020. <a href="https://doi.org/10.1002/rcm.8858">What can we learn from <span><span class="math inline">\(\text{N}_2\text{O}\)</span></span> isotope data?–analytics, processes and modelling</a>. Rapid Communications in Mass Spectrometry 34:e8858.
</div>
</div>
</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./results.html" class="pagination-link" aria-label="Results">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Results</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./uncertainty-analysis.html" class="pagination-link" aria-label="Uncertainty analysis">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uncertainty analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/damian-oswald/process-rate-estimator/blob/main/sensitivity-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/damian-oswald/process-rate-estimator/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>