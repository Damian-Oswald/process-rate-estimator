<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Damian Oswald">
<meta name="dcterms.date" content="2023-09-23">

<title>Process Rate Estimator</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="process-rate-estimator_files/libs/clipboard/clipboard.min.js"></script>
<script src="process-rate-estimator_files/libs/quarto-html/quarto.js"></script>
<script src="process-rate-estimator_files/libs/quarto-html/popper.min.js"></script>
<script src="process-rate-estimator_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="process-rate-estimator_files/libs/quarto-html/anchor.min.js"></script>
<link href="process-rate-estimator_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="process-rate-estimator_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="process-rate-estimator_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="process-rate-estimator_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="process-rate-estimator_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="README.md"><i class="bi bi-file-code"></i>Github (GFM)</a></li><li><a href="process-rate-estimator.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Process Rate Estimator</h1>
<p class="subtitle lead">A modeling side-hustle for the ETH group sustainable agroecosystems</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Damian Oswald </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><span class="math display">\[
\def\Ds{\text{D}_{\text{s}}}
\]</span></p>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Denitrification is the natural process by which nitrate (NO<sub>3</sub><sup>-</sup>) in the soil are converted by bacteria into nitrous oxide (N<sub>2</sub>O) or pure nitrigen (N<sub>2</sub>). The latter is called <em>total denitrification</em> — the full process described in <a href="#eq-denitrification">Equation&nbsp;1</a> takes place.</p>
<p><span id="eq-denitrification"><span class="math display">\[
\ce{NO3^- -&gt;[\text{Nitrate}][\text{reductase}] NO2^- -&gt;[\text{Nitrite}][\text{reductase}] NO -&gt;[\text{Nitrite oxide}][\text{reductase}] N2O^- -&gt;[\text{Nitrous oxide}][\text{reductase}] N2}
\tag{1}\]</span></span></p>
<p>Denitrification occurs in conditions where oxygen is limited, such as waterlogged soils. It is part of the nitrogen cycle, where nitrogen is circulated between the atmosphere, organisms and the earth.</p>
</section>
<section id="formal-model-description" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Formal model description</h1>
<section id="model-parameters" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="model-parameters"><span class="header-section-number">2.1</span> Model parameters</h2>
<div id="tbl-parameters" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Overview of the parameters used in the model.</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 55%">
<col style="width: 15%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Code</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Value</th>
<th style="text-align: left;">Unit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(BD\)</span></td>
<td style="text-align: left;"><code>BD</code></td>
<td style="text-align: left;">Bulk density (mass of the many particles of the material divided by the bulk volume)</td>
<td style="text-align: left;"><span class="math inline">\(1.686\)</span></td>
<td style="text-align: left;">g cm<sup>-3</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\theta_w\)</span></td>
<td style="text-align: left;"><code>theta_w</code></td>
<td style="text-align: left;">Soil volumetric water content</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\theta_a\)</span></td>
<td style="text-align: left;"><code>theta_a</code></td>
<td style="text-align: left;">Air-filled porosity</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\theta_t\)</span></td>
<td style="text-align: left;"><code>theta_t</code></td>
<td style="text-align: left;">Total soil porosity</td>
<td style="text-align: left;"><span class="math inline">\(1-\frac{BD}{2.65}\)</span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\text T\)</span></td>
<td style="text-align: left;"><code>temperature</code></td>
<td style="text-align: left;">Soil temperature</td>
<td style="text-align: left;"><span class="math inline">\(298\)</span></td>
<td style="text-align: left;">K</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Ds\)</span></td>
<td style="text-align: left;"><code>D_s</code></td>
<td style="text-align: left;">Gas diffusion coefficient</td>
<td style="text-align: left;"><a href="#eq-Ds">Equation&nbsp;3</a></td>
<td style="text-align: left;">m<sup>2</sup>s<sup>-1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_{\text{fw}}\)</span></td>
<td style="text-align: left;"><code>D_fw</code></td>
<td style="text-align: left;">Diffusivity of N<sub>2</sub>O in water</td>
<td style="text-align: left;"><a href="#eq-Dfw">Equation&nbsp;5</a></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D_{\text{fa}}\)</span></td>
<td style="text-align: left;"><code>D_fa</code></td>
<td style="text-align: left;">Diffusivity of N<sub>2</sub>O in air</td>
<td style="text-align: left;"><a href="#eq-Dfa">Equation&nbsp;6</a></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_{\text{fa,NTP}}\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Free air diffusion coefficient under standard conditions</td>
<td style="text-align: left;"><a href="#eq-Dfa">Equation&nbsp;6</a></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n\)</span></td>
<td style="text-align: left;"><code>n</code></td>
<td style="text-align: left;">Empirical parameter<span class="citation" data-cites="massman1998review"><sup><a href="#ref-massman1998review" role="doc-biblioref">1</a></sup></span></td>
<td style="text-align: left;">1.81</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(H\)</span></td>
<td style="text-align: left;"><code>H</code></td>
<td style="text-align: left;">Dimensionless Henry’s solubility constant</td>
<td style="text-align: left;"><a href="#eq-H">Equation&nbsp;4</a></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\rho\)</span></td>
<td style="text-align: left;"><code>rho</code></td>
<td style="text-align: left;">Gas density of N<sub>2</sub>O</td>
<td style="text-align: left;"><span class="math inline">\(1.26 \times 10^6\)</span></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<p>The diffusion fluxes between soil increments are described by Frick’s law (<a href="#eq-frick">Equation&nbsp;2</a>).</p>
<p><span id="eq-frick"><span class="math display">\[F_{\text{calc}} = \frac{dC}{dZ} D_{\text s} \rho \tag{2}\]</span></span></p>
<p>Here, <span class="math inline">\(D_s\)</span> is the gas diffusion coefficient, <span class="math inline">\(\rho\)</span> is the gas density of N<sub>2</sub>O, and <span class="math inline">\(\frac{dC}{dZ}\)</span> is the N<sub>2</sub>O concentration gradient from lower to upper depth. The fluxes are calculated based on N<sub>2</sub>O concentration gradients between 105-135 cm, 75-105 cm, 45-75 cm, 15-45 cm, and 0-15 cm depth layers, and ambient air above the soil surface.</p>
<p><span class="math inline">\(\theta_w\)</span> is the soil volumetric water content, <span class="math inline">\(\theta_a\)</span> the air-filled porosity, and <span class="math inline">\(\theta_T\)</span> is the total soil porosity.</p>
<p>The gas diffusion coefficient <span class="math inline">\(D_{\text s}\)</span> was calculated according <a href="#eq-Ds">Equation&nbsp;3</a> as established by Millington and Quirk in 1961.<span class="citation" data-cites="millington1961permeability"><sup><a href="#ref-millington1961permeability" role="doc-biblioref">2</a></sup></span></p>
<p><span id="eq-Ds"><span class="math display">\[D_{\text s} = \left( \frac{\theta_w^{\frac{10}{3}} + D_{\text fw}}{H} + \theta_a^{\frac{10}{3}} \times D_{\text fa} \right) \times \theta_T^{-2} \tag{3}\]</span></span></p>
<p>Here, <span class="math inline">\(H\)</span> represents a dimensionless form of Henry’s solubility constant (<span class="math inline">\(H'\)</span>) for N<sub>2</sub>O in water at a given temperature. The constant <span class="math inline">\(H\)</span> for N<sub>2</sub>O is calculated as follows:</p>
<p><span id="eq-H"><span class="math display">\[H = \frac{8.5470 \times 10^5 \times \exp \frac{-2284}{\text T}}{\text R \times \text T} \tag{4}\]</span></span></p>
<p>Here, <span class="math inline">\(\text R\)</span> is the gas constant, and <span class="math inline">\(\text T\)</span> is the temperature (<span class="math inline">\(\text T = 298 \; \text K\)</span>).</p>
<p><span class="math inline">\(D_{\text{fw}}\)</span> was calculated according to <a href="#eq-Dfw">Equation&nbsp;5</a> as documented by Versteeg and Van Swaaij (1988).<span class="citation" data-cites="versteeg1988solubility"><sup><a href="#ref-versteeg1988solubility" role="doc-biblioref">3</a></sup></span></p>
<p><span id="eq-Dfw"><span class="math display">\[D_{\text{fw}} = 5.07 \times 10^{-6} \times \exp \frac{-2371}{\text T} \tag{5}\]</span></span></p>
<p><span id="eq-Dfa"><span class="math display">\[D_{\text{fa}} = D_{\text{fa, NTP}} \times \left( \frac{\text T}{273.15} \right)^n \times \left( \frac{101'325}{\text P} \right) \tag{6}\]</span></span></p>
</section>
<section id="state-function-set" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="state-function-set"><span class="header-section-number">2.2</span> State function set</h2>
<p>Still to do.</p>
</section>
</section>
<section id="the-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> The data</h1>
<p>The study uses data collected from a mesocosm experiment – i.e.&nbsp;an outdoor experiment that examines the natural environment under controlled conditions. The experiment was set up as a randomized complete block design, with 4 varieties and 3 replicates, using 12 non-weighted lysimeters. A non-weighted lysimeter is a device to measure the amount of water that drains through soil, and to determine the types and amounts of dissolved nutrients or contaminants in the water. Each lysimeter had five sampling ports with soil moisture probes and custom-built pore gas sample, at depths of 7.5, 30, 60, 90 and 120 cm below soil surface.</p>
<p><span id="eq-dimension"><span class="math display">\[4 \times 3 \times 5 \times 161 = 9660 \tag{7}\]</span></span></p>
<p><a href="#eq-dimension">Equation&nbsp;7</a> shows how many observations we should expect to have. In reality, some observations are missing.</p>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-line-spacing="2" role="list">
<div id="ref-massman1998review" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Massman, W. A review of the molecular diffusivities of H2O, CO2, CH4, CO, O3, SO2, NH3, N2O, NO, and NO2 in air, O2 and N2 near STP. <em>Atmospheric environment</em> <strong>32</strong>, 1111–1127 (1998).</div>
</div>
<div id="ref-millington1961permeability" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Millington, R. &amp; Quirk, J. Permeability of porous solids. <em>Transactions of the Faraday Society</em> <strong>57</strong>, 1200–1207 (1961).</div>
</div>
<div id="ref-versteeg1988solubility" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Versteeg, G. F. &amp; Van Swaaij, W. P. Solubility and diffusivity of acid gases (carbon dioxide, nitrous oxide) in aqueous alkanolamine solutions. <em>Journal of Chemical &amp; Engineering Data</em> <strong>33</strong>, 29–34 (1988).</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>